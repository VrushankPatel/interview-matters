---
title: Monitoring with Prometheus and Grafana
aliases: [Prometheus Grafana Monitoring, Observability Stack]
tags: [#system-design,#devops,#monitoring]
created: 2025-09-25
updated: 2025-09-25
---

## Overview

Monitoring with Prometheus and Grafana forms a powerful observability stack for collecting, storing, and visualizing metrics from applications and infrastructure. Prometheus excels at time-series data collection via pull-based scraping, while Grafana provides rich dashboards for data visualization and alerting.

## Detailed Explanation

### Prometheus Architecture

Prometheus uses a pull-based model where it scrapes metrics from configured targets at regular intervals. Key components include:

- **Prometheus Server**: Core component that scrapes and stores time-series data
- **Exporters**: Agents that expose metrics from applications/services
- **Alertmanager**: Handles alerts generated by Prometheus rules
- **Pushgateway**: Allows ephemeral jobs to push metrics

### Grafana Features

Grafana connects to various data sources (including Prometheus) and provides:
- Interactive dashboards with panels
- Alerting capabilities
- User management and permissions
- Plugin ecosystem for extended functionality

### Metrics Collection

Prometheus collects four types of metrics:
- **Counter**: Monotonically increasing value (e.g., requests served)
- **Gauge**: Value that can go up or down (e.g., current memory usage)
- **Histogram**: Samples observations and counts them in buckets
- **Summary**: Similar to histogram but calculates quantiles

## Real-world Examples & Use Cases

### E-commerce Platform Monitoring

```yaml
# prometheus.yml configuration
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'ecommerce-app'
    static_configs:
      - targets: ['app-server:8080']
  - job_name: 'database'
    static_configs:
      - targets: ['db-server:3306']
```

### Microservices Observability

In a microservices architecture, Prometheus can monitor:
- Service response times
- Error rates per endpoint
- Resource utilization across pods
- Database connection pools

### Infrastructure Monitoring

Track server metrics like CPU usage, memory consumption, disk I/O, and network traffic across a cluster of machines.

## Code Examples

### Prometheus Configuration

```yaml
# Complete prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  - "alert_rules.yml"

alerting:
  alertmanagers:
    - static_configs:
        - targets:
          - alertmanager:9093

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'node'
    static_configs:
      - targets: ['node-exporter:9100']
```

### Grafana Dashboard JSON (Snippet)

```json
{
  "dashboard": {
    "title": "System Metrics",
    "panels": [
      {
        "title": "CPU Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)",
            "legendFormat": "{{instance}}"
          }
        ]
      }
    ]
  }
}
```

### Alert Rules

```yaml
groups:
  - name: example
    rules:
      - alert: HighRequestLatency
        expr: http_request_duration_seconds{quantile="0.5"} > 0.5
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "High request latency"
```

## References

- [Prometheus Documentation](https://prometheus.io/docs/)
- [Grafana Documentation](https://grafana.com/docs/)
- [Prometheus Best Practices](https://prometheus.io/docs/practices/)
- [Grafana Dashboards Gallery](https://grafana.com/grafana/dashboards/)

## Github-README Links & Related Topics

- [Monitoring and Logging](./monitoring-and-logging/README.md)
- [Distributed Tracing](./distributed-tracing/README.md)
- [Observability Patterns](./system-design/observability-patterns/README.md)
- [Kubernetes Monitoring](./kubernetes-basics/README.md)